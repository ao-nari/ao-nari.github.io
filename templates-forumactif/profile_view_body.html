<!-- IMPORTANT!!-->
<!-- ACTIVATE SIMPLE PROFILE: Users & Groups › Profiles › General options › Activate advanced profile: no -->

<!-------------------------------->
<!-- PAGE PROFIL -->

<div class="container__profile">

    <!-- HEADER -->
    <div class="profile__header">
        <!-- nom -->
        <span class="profile__title">{USERNAME}</span>

        <!-- rang -->
        <span class="profile__rank">{POSTER_RANK}</span>

        <!-- BEGIN profile_field -->
        <div class="profile_field" id="field_id{profile_field.ID}">
            <div class="field_label">{profile_field.LABEL}</div>
            <div class="field_content">{profile_field.CONTENT}</div>
        </div>
        <!-- END profile_field -->

        <div class="profile__links">
            <!-- BEGIN profile_field -->
            <!-- BEGIN profil_type_user_posts -->
            <div class="profile__topicslink"><a rel="nofollow" href="/sta/{PUSERNAME}" id="alltopics">{L_TOPICS}</a></div> <!-- lien sujets -->
            <div class="profile__msgslink"><a rel="nofollow" href="/spa/{PUSERNAME}" id="allposts">{L_POSTS}</a></div> <!-- lien messages -->
            <!-- END profil_type_user_posts -->
            <!-- END profile_field --> 

            <!-- autres liens -->
            <div class="profile__misclinks">
                <!-- BEGIN contact_field -->
                <div id="field_id{contact_field.ID}">{contact_field.CONTENT}</div>
                <!-- END contact_field -->
            </div>
        </div>
    </div>

    <!-- CORPS PRINCIPAL -->
    <div class="profile__main">
        <!-- côté gauche (personnage) -->
        <div class="profile__char">
            <div class="profile__charin">
                <!-- BEGIN profile_field -->
                <div class="profile_field" id="field_id{profile_field.ID}">
                    <div class="field_label">{profile_field.LABEL}</div>
                    <div class="field_content">{profile_field.CONTENT}</div>
                </div>
                <!-- END profile_field -->
            </div>

            <!-- messages -->
            <div class="profile__messages"></div>

            <!-- points (auras) -->
            <div class="profile__auras"></div>

            <!-- dialogues -->
            <div class="profile__dialogues"></div>
        </div>

        <!-- avatar -->
        <div class="profil_avatar" id="user_avatar">{AVATAR_IMG}</div>

        <!-- côté droit (joueur) -->
        <div class="profile__player">
            <!-- BEGIN profile_field -->
            <div class="profile_field" id="field_id{profile_field.ID}">
                <div class="field_label">{profile_field.LABEL}</div>
                <div class="field_content">{profile_field.CONTENT}</div>
            </div>
            <!-- END profile_field -->
        </div>
    </div>

    <!-- FOOTER (bloc pouvoirs optionel) -->
    <div class="profile__footer">
        <!-- code -->
    </div>
</div>

<!-- JAVASCRIPT -->

<script>
document.addEventListener("DOMContentLoaded", function() {
    var profileTitleSpans = document.querySelectorAll('.profile__title span[style*="color"]');
  
    profileTitleSpans.forEach(function(span) {
        var color = window.getComputedStyle(span).getPropertyValue("color");
        var rgbaColor = addOpacity(color, 0.3);
        var baseClr90 = getComputedStyle(document.documentElement).getPropertyValue('--baseClr-90').trim();
        var gradientColor = "linear-gradient(to top, " + rgbaColor + ", " + baseClr90 + ")";
        var elements = document.querySelectorAll('.profile__header, .profile__main, .profile__footer');
  
        elements.forEach(function(element) {
            element.style.background = gradientColor;
        });
    });

    function addOpacity(color, opacity) {
        var rgbaComponents = color.match(/\d+/g);
        if (rgbaComponents) {
            rgbaComponents[3] = opacity;
            return "rgba(" + rgbaComponents.join(", ") + ")";
        }
        return color;
    }
});
</script>

<script src="{JQUERY_ROOT}json/jquery.json-1.3.min.js" type="text/javascript"></script>
<script type="text/javascript">
    //<![CDATA[
    $(document).ready(function() {
        $('[id^=field_id]').each(function() {
            if ($(this).find('.field_editable').is('span, div')) {
                $(this).hover(function() {
                    if ($(this).find('.field_editable.invisible').is('span, div')) {
                        $(this).find('.field_editable').prev().addClass('ajax-profil_hover').parent().addClass('ajax-profil_parent').append('<div class="ajax-profil_edit"><img src="{AJAX_EDIT_IMG}" /></div>');
                        $(this).find('.ajax-profil_edit').attr({
                            alt: "{L_FIELD_EDIT_VALUE}",
                            title: "{L_FIELD_EDIT_VALUE}"
                        }).click(function() {
                            $(this).prev().prev().removeClass('ajax-profil_hover').addClass('invisible').next().removeClass('invisible').append('<img src="{AJAX_VALID_IMG}" class="ajax-profil_valid" />').find('input,select');
                            $(this).prev().find('.ajax-profil_valid').attr({
                                alt: "{L_VALIDATE}",
                                title: "{L_VALIDATE}"
                            }).click(function() {
                                var content = new Array();
                                $(this).parent().find('[name]').each(function() {
                                    var type_special = $(this).is('input[type=radio],input[type=checkbox]');
                                    if ((type_special && $(this).is(':checked')) || !type_special) {
                                        content.push(new Array($(this).attr('name'), $(this).attr('value')));
                                    }
                                });
                                var id_name = $(this).parents('[id^=field_id]').attr('id');
                                var id = id_name.substring(8, id_name.length);
                                $.post(
                                    "{U_AJAX_PROFILE}", {
                                        id: id,
                                        user: "{CUR_USER_ID}",
                                        active: "{CUR_USER_ACTIVE}",
                                        content: $.toJSON(content),
                                        tid: "{TID}"
                                    },
                                    function(data) {
                                        $.each(data, function(i, item) {
                                            $('[id=field_id' + i + ']').find('.field_uneditable').html(item).end().find('.ajax-profil_valid').remove().end().find('.field_editable').addClass('invisible').end().find('.field_uneditable').removeClass('invisible');
                                        });
                                    },
                                    "json"
                                );
                            });
                            $(this).remove();
                        });
                    }
                }, function() {
                    if ($(this).find('.field_editable.invisible').is('span, div')) {
                        $(this).find('.field_editable').prev().removeClass('ajax-profil_hover');
                        $(this).find('.ajax-profil_edit').remove();
                    }
                });
            }
        });
    });
    //]]>
</script>